# Generate favicon hash

I came across a post indicating that [over 45,000 Jenkins instances were vulnerable](https://www.bleepingcomputer.com/news/security/45k-jenkins-servers-exposed-to-rce-attacks-using-public-exploits/) to this particular vulnerability. This led me to consider utilizing Shodan, which essentially maps the entire internet, to analyze the extent of vulnerable instances exposed to the internet.

To identify exposed instances, I wrote a Python script to generate the MurmurHash3 hash for the site's favicon.

```bash
❯ python gen_favicon_hash.py http://localhost:1234
Favicon hash: 81586312
```

Subsequently, I used the hash in a Shodan query to search for Jenkins instances, which yielded 83,655 results.

```bash
❯ shodan count "http.favicon.hash:81586312"
83655
```

Regrettably, many of these, even those accessible on the internet, require some form of authorization. So, I adjusted the query to filter results returning a 200 status code, reducing the results to 13,164.

```bash
❯ shodan count "http.favicon.hash:81586312 200"
13164

❯ shodan stats "http.favicon.hash:81586312 200"
Top 10 Results for Facet: country
CN                                              12,529
US                                              307
DE                                              55
FR                                              42
SG                                              27
IN                                              23
GB                                              19
KR                                              18
HK                                              16
IE                                              16

Top 10 Results for Facet: org
Aliyun Computing Co., LTD                       10,407
Aliyun Computing Co.LTD                         1,007
China Mobile Communications Corporation         184
CHINANET SHANGHAI PROVINCE NETWORK              121
Amazon Technologies Inc.                        120
China Unicom Shandong Province Network          93
Zhejiang Taobao Network Co.,Ltd                 88
CHINANET Guangdong province network             68
Hangzhou Alibaba Advertising Co.,Ltd.           63
Amazon.com, Inc.                                49
```

Analyzing 13k results would require a decent amount of Shodan credits and time. Given that the United States had just over 300 results, I opted to focus on analyzing instances there.

```bash
❯ date -u
Sunday 04 February 2024 11:38:28 PM UTC

❯ python shodan_analysis.py
[i] Using query: http.favicon.hash:81586312 200 country:US
[i] Total Jenkins instances found: 307
[+] Vulnerable instances found: 206 | Current count: 305

[*] Querying complete!

[+] Total vulnerable instances: 206
[+] 100 instances not vulnerable or unable to determine their version
```

It turns out that out of the 307 instances identified, **206 (67.10%)** haven't upgraded their instances. While it's plausible that some may have implemented the temporary workaround suggested by Jenkins, the fact that a significant number still utilizes the vulnerable version, even 12 days after a CVE was assigned for the vulnerability, is concerning.
